

import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';

export interface SkeletonProps extends React.HTMLAttributes<HTMLDivElement> {
  variant?: 'default' | 'card' | 'text' | 'avatar' | 'button';
  animated?: boolean;
}

const skeletonVariants = {
  default: 'bg-[var(--color-surface-muted)] rounded-lg',
  card: 'bg-[var(--color-surface-muted)] rounded-[28px]',
  text: 'bg-[var(--color-surface-muted)] rounded-md h-4',
  avatar: 'bg-[var(--color-surface-muted)] rounded-full',
  button: 'bg-[var(--color-surface-muted)] rounded-full h-10',
};

export function Skeleton({
  className,
  variant = 'default',
  animated = true,
  ...props
}: SkeletonProps) {
  const SkeletonComponent = animated ? motion.div : 'div';
  const motionProps = animated
    ? {
        animate: {
          opacity: [0.5, 1, 0.5],
        },
        transition: {
          duration: 1.5,
          repeat: Infinity,
          ease: 'easeInOut',
        },
      }
    : {};

  return (
    <SkeletonComponent
      className={cn(skeletonVariants[variant], className)}
      {...motionProps}
      {...props}
    />
  );
}

// Preset skeleton components for common use cases
export function ProductCardSkeleton() {
  return (
    <div className="overflow-hidden rounded-[30px] border border-[color-mix(in_srgb,var(--color-border)80%,white)] bg-white/90 shadow-[var(--shadow-soft)]">
      <Skeleton variant="card" className="aspect-square" />
      <div className="flex flex-col gap-4 px-5 py-6">
        <div className="flex items-start justify-between">
          <div className="space-y-2 flex-1">
            <Skeleton variant="text" className="w-3/4" />
            <Skeleton variant="text" className="w-1/2 h-3" />
          </div>
          <Skeleton variant="text" className="w-12" />
        </div>
        <Skeleton variant="text" className="w-full h-12" />
        <div className="flex gap-2">
          <Skeleton variant="text" className="w-16 h-6 rounded-full" />
          <Skeleton variant="text" className="w-20 h-6 rounded-full" />
        </div>
        <div className="flex gap-3">
          <Skeleton variant="button" className="flex-1" />
          <Skeleton variant="button" className="flex-1" />
        </div>
      </div>
    </div>
  );
}

export function BuilderOptionSkeleton() {
  return (
    <div className="flex w-full items-start justify-between rounded-2xl border border-[color-mix(in_srgb,var(--color-border)80%,white)] px-4 py-3">
      <div className="flex flex-col gap-2 flex-1">
        <Skeleton variant="text" className="w-2/3" />
        <Skeleton variant="text" className="w-full h-3" />
        <Skeleton variant="text" className="w-16 h-5 rounded-full" />
      </div>
      <div className="flex flex-col items-end gap-1">
        <Skeleton variant="text" className="w-12 h-3" />
        <Skeleton variant="avatar" className="h-2 w-2" />
      </div>
    </div>
  );
}

export function CatalogFilterSkeleton() {
  return (
    <div className="space-y-4">
      <Skeleton variant="text" className="w-20" />
      <div className="flex flex-wrap gap-2">
        {Array.from({ length: 6 }).map((_, i) => (
          <Skeleton key={i} variant="text" className="w-16 h-7 rounded-full" />
        ))}
      </div>
    </div>
  );
}
